ðŸ§© SECTION 1 â€” ANALYTICAL & BUSINESS-ORIENTED SQL

Customer Lifetime Value (CLV)
1. Find the total revenue generated by each customer and rank them by total spend (top 10 customers).
1. with cte1 as (select customer_id, sum(revenue) as sum_rev from orders),
cte2 as (select cte1.customer_id, cte1.sum_rev, dense_rank() over (partition by cte1.customer_id order by sum_rev desc) as ranking from cte1)
select cte2.customer_id, cte2.sum_rev, cte2.ranking from cte2 where ranking between 1 and 10

Customer Retention Rate
2. Count how many customers placed orders in both January 2024 and February 2024.
2. 

Cohort Analysis (Month of First Purchase)
3. Find for each customer their first purchase month and the total number of orders theyâ€™ve made since.
3. with cte1 as (select customer_id , order_date, min(order_date) as first_date from orders),
cte2 as (select cte1.customer_id,cte1.first_date, rank() over (partition cte1.customer_id order by first_date) as ranking from cte1)
select cte2.customer_id, month(cte1.first_date) as first_month, max(ranking) from cte2 group by cte2.customer_id, month(cte1.first_date)
 
Repeat Purchase Behavior
4. Find customers who have made at least 3 purchases, each more than â‚¹500.
4. 

Category Prefernce
5. For each customer, identify their most frequently purchased product category.
5. with cte1 as (select  customer_id, product_cat from orders order by customer_id, product_cat),
cte2 as (select cte1.customer_id, cte1.product_cat, count(cte1.product_cat) as cnt from cte1 group by cte1.customer_id, cte1.product_cat)
select cte2.customer_id, cte2.product_cat, max(cte2.cnt) from cte2 group by cte2.customer_id, cte2.product_cat

Spending Growth
6. For each customer, find whether their spending increased or decreased compared to the previous month.
6. 

Churned Customers
List customers who placed an order in 2024 but not in 2025.

Customer Segmentation
Categorize customers into tiers based on their total spend:

Platinum (â‰¥ â‚¹10,000)

Gold (â‚¹5,000â€“â‚¹9,999)

Silver (< â‚¹5,000)
