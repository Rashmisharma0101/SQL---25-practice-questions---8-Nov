‚öôÔ∏è SECTION 2 ‚Äî WINDOW FUNCTIONS & ADVANCED LOGIC

Top-N by Category
1. Find the top 3 highest-priced products within each category.
1. with cte1 as (select product_id, product_cat, price, rank() over (partition by product_cat order by price desc) as rnk from products)
select cte1.product_id, product_cat, price from cte1 where rnk <=3
ORDER BY product_cat, price DESC;  # order by of rak function does not afect the output of query, only affects how the rank is assigned

Second Highest Salary per Department
Return the employee(s) with the 2nd highest salary in each department.

Month-over-Month Growth
For each month, calculate total sales and growth % compared to the previous month.

Rank Orders
For each customer, assign a rank to their purchases by order date and find customers whose 2nd order was larger than their 1st (similar to one you did üí™).

Running Total
Show cumulative sales for each day of 2024, ordered by date.

Moving Average
Calculate the 7-day moving average of daily sales.

Percentage Contribution
For each product, show what percentage of its category‚Äôs total revenue it contributed.

Time-to-Second Purchase
Calculate the number of days between each customer‚Äôs first and second purchase.
